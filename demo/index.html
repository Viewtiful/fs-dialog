<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">
    <link rel="stylesheet" href="../../fs-styles/dist/familysearch-styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/themes/prism.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/themes/prism-okaidia.min.css">

    <title>fs-dialog demo</title>

    <script src="array-from-polyfill.js"></script>
    <script src="../../es6-promise/es6-promise.auto.js"></script>
    <script src="../../webcomponentsjs/webcomponents-lite.js"></script>
    <style>
      .demo-snippet {
        margin-bottom: 40px;
      }

      .fs-card {
        padding: 5px;
      }

      [dynamic] ul {
        list-style: none;
        margin: 0 0 10px 0;
      }

      [dynamic] label {
        display: inline-block;
      }

      [dynamic] select {
        width: inherit;
      }

      .demo-snippet details:not([open]) summary {
        cursor: help;
      }

      summary {
        cursor: pointer;
        margin: 5px auto;
        padding: 10px;
        user-select: none;
      }

      .demo {
        display: hidden;
      }

      pre[class*="language-"] {
        margin: 0;
        padding: 20px;
      }

      /* begin fs-styles override */
      fieldset {
        border: 1px solid #777;
        margin-bottom: 10px;
        padding: 8px;
      }
      fieldset legend {
        font-size: 1.25rem;
        line-height: 1.5rem;
      }
      /* end fs-styles override */

    </style>
  </head>
  <body>

    <div class="demo-snippet fs-card">
      <form action="#" dynamic>
        <h2>Dynamic configuration demo card of awesomeness:</h2>

        <label>Dialog Type</label>
        <ul>
          <li>
            <input name="type" type="radio" id="modal" checked="">
            <label for="modal">Modal</label>
          </li>
          <li>
            <input name="type" type="radio" id="modeless">
            <label for="modeless">Modeless</label>
          </li>
          <li>
            <input name="type" type="radio" id="anchored">
            <label for="anchored">Anchored</label>
          </li>
        </ul>

        <fieldset>
          <legend>data-specific options:</legend>

          <label>Content Size</label>
          <ul>
            <li>
              <input name="content-size" type="radio" id="short" checked="">
              <label for="short">Short</label>
            </li>
            <li>
              <input name="content-size" type="radio" id="medium">
              <label for="medium">Medium</label>
            </li>
            <li>
              <input name="content-size" type="radio" id="long">
              <label for="long">Long</label>
            </li>
          </ul>

          <label for="maxHeight">max-height</label>
          <div class="fs-field-group">
            <input class="fs-field-group__input" id="maxHeight" type="text"  maxlength="20" placeholder="example: 400px">
            <div class="fs-field-group__attachment">
              <input type="checkbox" id="max-height">
              <label for="max-height"></label>
            </div>
          </div>

          <label>Nesting</label>
          <ul>
            <li>
              <input name="nesting" type="radio" id="none" checked="">
              <label for="none">None</label>
            </li>
            <li>
              <input name="nesting" type="radio" id="one">
              <label for="one">One</label>
            </li>
            <li>
              <input name="nesting" type="radio" id="two">
              <label for="two">Two</label>
            </li>
          </ul>
        </fieldset>

        <fieldset>
          <legend>fs-anchored-dialog-specific options:</legend>

          <input type="checkbox" name="no-pointer" id="noPointer"><label for="noPointer">no-pointer</label>

          <label for="pointerDirection">pointer-direction</label>
          <select name="pointer-direction" id="pointerDirection">
            <option value=""></option>
            <option value="down">down</option>
          </select>

          <label for="attachDirection">attach-direction</label>
          <select name="attach-direction" id="attachDirection">
            <option value=""></option>
            <option value="center">center</option>
          </select>

          <label for="alignment">alignment</label>
          <select name="alignment" id="alignment">
            <option value=""></option>
            <option value="left">left</option>
          </select>

        </fieldset>

        <fieldset>
          <legend>fs-modal-dialog-specific options:</legend>


        </fieldset>
      </form>

      <button class="modal fs-button fs-button--recommended">Open Dialog</button>

      <div class="dynamic demo">
        <dynamic-demo-element></dynamic-demo-element>
      </div>
    </div>

<br><br><br><br><br><br>

    <h3>Other Functions and Attributes</h3>
    <div class="demo-snippet fs-card">
      <div class="demo do-not-codify">
        <h5>Open Function Options</h5>
        <p>There are some required parameters to the open function. The function takes one argument which is an options object. The options object always needs a focusBackElement property is required if you want to have the correct element focus when the dialog closes. For anchored dialogs, attachToElement is required.</p>
        <h5>Opt-out of fullscreen on mobile</h5>
        <p>To opt out of making an anchored or modal dialog go fullscreen on mobile devices, add the attribute <code>fullscreen-on-mobile="false"</code></p>
        <h5>autofocus</h5>
        <p>Set the attribute <code>autofocus</code> on the element in the dialog that you want to be focused on first open. If autofocus is not set, the dialog itself gets focus</p>
        <h5>closeAndCloseChildren</h5>
        <p>To close a dialog and all the dialogs above it in the stack, you can call <code>lt;dialog-element&gt;.closeAndCloseChildren()</code> This will automatically use the same direction of transition for all dialogs (whatever the dialog element that you use to call the function has).</p>
        <h5>focusable-component</h5>
        <p>In order to loop users through the modal and anchored dialogs when they press the tab key, we do a query selector to get all focusable elements. If you put a component in the dialog that needs to be able to get focus, please add the attribute <code>focusable-component</code> to it so that we don't break tab looping.</p>
        <h5>closeAllDialogs</h5>
        <p>To close all modal and anchored dialogs on the page you can call <code>FS.dialog.service.closeAllDialogs()</code> This does not close modeless dialogs.</p>
        <h5>Auto-hiding dialogs from initial load</h5>
        <p>While the component is loading, you may get flashes of dialogs being visible/unstyled. To avoid this, add these styles to the css early in your page.</p>
<pre>
  fs-modeless-dialog,
  fs-modal-dialog,
  fs-anchored-dialog {
    visibility: hidden;
    opacity: 0;
    display: none;
  }
</pre>
      </div>
    </div>

    <h3></h3>
    <div class="demo-snippet fs-card">
      <details open>
        <summary><strong>Design and Business Logic Decisions:</strong></summary>
        <ul>
          <li>By default:<ul>
            <li>All modal dialogs do not have dismiss on blur</li>
            <li>All modal dialogs have close on escape functionality</li>
            <li>All modal dialogs show the close "X"</li>
            <li>All modal dialogs go full-screen at 480px</li>
          </ul></li>
        </ul>
      </details>
      <details>
        <summary><strong>TODO List:</strong></summary>
        <ul>
          <li>Create dynamic demo/code example</li>
          <li>Fix IE11 bugs</li>
          <li>Get unit tests written/working</li>
        </ul>
      </details>
    </div>

    <script>
    (function() {

      // Generate details-->pre-->code example code blocks
      function generateCodeSnippet(generatedCode) {
        Array.from(document.querySelectorAll('.demo:not(.do-not-codify)')).forEach(function(demo) {
          if (demo.parentNode.querySelector('details')) {
            // Keep details open on update if it was already
            var open = demo.parentNode.querySelector('details').hasAttribute("open");
            demo.parentNode.querySelector('details').remove();
          }

          var code = (generatedCode) ? generatedCode.outerHTML : demo.innerHTML
            .trim()
            .replace(/<\/?demo-/g, '&lt;')
            .replace(/</g, '&lt;')
            .replace(/>/g, '&gt;');
          var preEl = document.createElement('pre');
          var codeEl = document.createElement('code');
          preEl.classList.add('language-markup');
          codeEl.classList.add('language-markup');
          codeEl.innerHTML = (window.Prism) ? Prism.highlight(code, Prism.languages.html) : code;

          var wrapperEl = document.createElement('details');
          if (open) { wrapperEl.setAttribute("open", ""); }
          var summaryEl = document.createElement('summary');
          summaryEl.innerHTML = 'Markup';
          summaryEl.setAttribute('title', 'Show/hide associated markup');

          demo.parentNode.insertBefore(wrapperEl, demo);
          preEl.appendChild(codeEl);
          wrapperEl.appendChild(summaryEl);
          wrapperEl.appendChild(preEl);
        });
      }

      // Generate dynamic dialog code
      function generateDialog() {
        var dynamicDialogButton = document.querySelector('.demo-snippet > button');
        dynamicDialogButton.addEventListener('click', function() {
          var demoEl = document.querySelector('.dynamic.demo');
          // Clear out previous dialog
          Array.from(demoEl.children).forEach(function(child) {
            child.remove();
          });
          // GET CONFIGURATION OPTIONS OUT OF DOM

          // TODO: CREATE CORRECT TYPE OF DIALOG
          dynamicDialogEl = document.createElement('fs-anchored-dialog');

          // TODO: SET ATTRIBUTES
          // TODO: SET CONTENT
          dynamicDialogEl.innerHTML = '<div class="fs-dialog__body"></div>';

          // TODO: THIS generateCodeSnippet CALL WILL NEED TO BE MOVED TO THE FORM ELEMENT ONCHANGE HANDLER
          generateCodeSnippet(dynamicDialogEl);
          // Append dynamic dialog to DOM and open
          demoEl.appendChild(dynamicDialogEl);
          dynamicDialogEl.open({focusBackElement: this});
        });

        var dynamicDemoInputs = document.querySelectorAll('input, select');
        Array.from(dynamicDemoInputs).forEach(function(input) {
          input.addEventListener('change', function(evt){
            console.log(evt.target);
          });
        });
      }

      // Init
      generateCodeSnippet();
      generateDialog();
    })();
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.8.4/prism.js'></script>

    <!-- by importing the elements last, the code output script can run before it gets
         populated -->
    <link rel='import' href='../fs-modeless-dialog.html'>
    <link rel='import' href='../fs-modal-dialog.html'>
    <link rel='import' href='../fs-anchored-dialog.html'>
  </body>
</html>
